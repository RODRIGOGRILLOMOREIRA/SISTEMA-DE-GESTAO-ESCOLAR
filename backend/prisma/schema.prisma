generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model alunos {
  id               String           @id
  nome             String
  cpf              String           @unique
  dataNascimento   DateTime
  email            String           @unique
  telefone         String?
  endereco         String?
  responsavel      String
  telefoneResp     String
  turmaId          String?
  numeroMatricula  String?
  statusMatricula  String?          @default("ATIVO")
  createdAt        DateTime         @default(now())
  updatedAt        DateTime
  turmas           turmas?          @relation(fields: [turmaId], references: [id])
  frequencias      frequencias[]
  matriculas       matriculas[]
  notas            notas[]
  presenca_aluno   PresencaAluno[]
  notas_finais     notas_finais[]   @relation("NotasFinaisToAluno")

  // Índices para otimização de performance
  @@index([turmaId])
  @@index([statusMatricula])
  @@index([turmaId, statusMatricula])
  @@index([nome])
  @@index([createdAt])
}

model calendario_escolar {
  id                 String               @id
  ano                Int                  @unique
  createdAt          DateTime             @default(now())
  updatedAt          DateTime
  eventos_calendario eventos_calendario[]
}

model configuracoes {
  id          String   @id
  nomeEscola  String
  redeEscolar String?
  endereco    String
  telefone    String?
  email       String?
  logoUrl     String?
  temaModo    String   @default("light")
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model disciplinas {
  id                  String                @id
  nome                String
  cargaHoraria        Int
  professorId         String?
  createdAt           DateTime              @default(now())
  updatedAt           DateTime
  professores         professores?          @relation(fields: [professorId], references: [id])
  disciplinas_turmas  disciplinas_turmas[]
  horarios_aula       horarios_aula[]
  notas               notas[]
  registro_frequencia registro_frequencia[]
  turmas              turmas[]              @relation("DisciplinaToTurma")
  notas_finais        notas_finais[]        @relation("NotasFinaisToDisciplina")
}

model disciplinas_turmas {
  id           String       @id
  disciplinaId String
  turmaId      String
  professorId  String?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime
  disciplinas  disciplinas  @relation(fields: [disciplinaId], references: [id], onDelete: Cascade)
  professores  professores? @relation(fields: [professorId], references: [id])
  turmas       turmas       @relation(fields: [turmaId], references: [id], onDelete: Cascade)

  @@unique([disciplinaId, turmaId])
}

model equipe_diretiva {
  id                     String                   @id
  nome                   String
  cpf                    String
  email                  String
  telefone               String?
  cargo                  String
  cargaHorariaSemanal    Int?                     @default(40)
  horarioEntradaPadrao   String?
  horarioSaidaPadrao     String?
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
}

model eventos_calendario {
  id                 String             @id
  calendarioId       String
  tipo               TipoEvento
  descricao          String?
  dataInicio         DateTime
  dataFim            DateTime?
  createdAt          DateTime           @default(now())
  updatedAt          DateTime
  calendario_escolar calendario_escolar @relation(fields: [calendarioId], references: [id], onDelete: Cascade)
}

model frequencias {
  id         String   @id
  alunoId    String
  turmaId    String
  data       DateTime
  presente   Boolean  @default(true)
  observacao String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime
  alunos     alunos   @relation(fields: [alunoId], references: [id])
  turmas     turmas   @relation(fields: [turmaId], references: [id])

  // Índices para otimização de performance
  @@index([alunoId])
  @@index([turmaId])
  @@index([data])
  @@index([alunoId, data])
  @@index([turmaId, data])
  @@index([presente])
}

model funcionarios {
  id                     String                   @id
  nome                   String
  cpf                    String
  email                  String
  telefone               String?
  cargo                  String
  setor                  String?
  cargaHorariaSemanal    Int?                     @default(40)
  horarioEntradaPadrao   String?
  horarioSaidaPadrao     String?
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
}

model grade_horaria {
  id            String          @id
  turmaId       String          @unique
  createdAt     DateTime        @default(now())
  updatedAt     DateTime
  turmas        turmas          @relation(fields: [turmaId], references: [id], onDelete: Cascade)
  horarios_aula horarios_aula[]
}

model horarios_aula {
  id                  String                @id
  gradeId             String
  diaSemana           DiaSemana
  periodo             String
  ordem               Int
  horaInicio          String
  horaFim             String
  disciplinaId        String?
  professorId         String?
  createdAt           DateTime              @default(now())
  updatedAt           DateTime
  disciplinas         disciplinas?          @relation(fields: [disciplinaId], references: [id])
  grade_horaria       grade_horaria         @relation(fields: [gradeId], references: [id], onDelete: Cascade)
  professores         professores?          @relation(fields: [professorId], references: [id])
  registro_frequencia registro_frequencia[]
}

model matriculas {
  id            String   @id
  alunoId       String
  turmaId       String
  dataMatricula DateTime @default(now())
  status        String   @default("ATIVA")
  createdAt     DateTime @default(now())
  updatedAt     DateTime
  alunos        alunos   @relation(fields: [alunoId], references: [id])
  turmas        turmas   @relation(fields: [turmaId], references: [id])
}

model notas {
  id                 String      @id
  alunoId            String
  disciplinaId       String
  trimestre          Int
  anoLetivo          Int         @default(2025)
  avaliacao01        Float?
  avaliacao02        Float?
  avaliacao03        Float?
  mediaM1            Float?
  avaliacaoEAC       Float?
  observacao         String?
  createdAt          DateTime    @default(now())
  updatedAt          DateTime
  notaFinalTrimestre Float?
  alunos             alunos      @relation(fields: [alunoId], references: [id])
  disciplinas        disciplinas @relation(fields: [disciplinaId], references: [id])

  // Índices para otimização de performance
  @@index([alunoId])
  @@index([disciplinaId])
  @@index([trimestre])
  @@index([alunoId, trimestre])
  @@index([disciplinaId, trimestre])
  @@index([alunoId, disciplinaId, trimestre])
  @@index([createdAt])
  @@unique([alunoId, disciplinaId, trimestre, anoLetivo])
}

model notas_finais {
  id           String      @id
  alunoId      String
  disciplinaId String
  anoLetivo    Int         @default(2025)
  mediaFinal   Float?
  createdAt    DateTime    @default(now())
  updatedAt    DateTime
  aprovado     Boolean     @default(false)
  trimestre1   Float?
  trimestre2   Float?
  trimestre3   Float?
  aluno        alunos      @relation("NotasFinaisToAluno", fields: [alunoId], references: [id])
  disciplina   disciplinas @relation("NotasFinaisToDisciplina", fields: [disciplinaId], references: [id])

  @@unique([alunoId, disciplinaId, anoLetivo])
}

model PresencaAluno {
  id                  String              @id @default(uuid())
  registroId          String
  alunoId             String
  presente            Boolean             @default(true)
  justificativa       String?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  aulaIndex           Int                 @default(0)
  alunos              alunos              @relation(fields: [alunoId], references: [id])
  registro_frequencia registro_frequencia @relation(fields: [registroId], references: [id], onDelete: Cascade)

  @@unique([registroId, alunoId, aulaIndex])
  @@map("presenca_aluno")
}

model professores {
  id                     String                   @id
  nome                   String
  cpf                    String
  email                  String
  telefone               String
  especialidade          String?
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
  area                   String?
  componentes            String?
  turmasVinculadas       String?
  cargaHorariaSemanal    Int?                     @default(40)
  horarioEntradaPadrao   String?
  horarioSaidaPadrao     String?
  disciplinas            disciplinas[]
  disciplinas_turmas     disciplinas_turmas[]
  horarios_aula          horarios_aula[]
  registro_frequencia    registro_frequencia[]
  turmas                 turmas[]
}

model registro_frequencia {
  id             String           @id
  turmaId        String
  disciplinaId   String
  professorId    String
  data           DateTime
  horarioAulaId  String?
  observacao     String?
  createdAt      DateTime         @default(now())
  updatedAt      DateTime
  periodo        String?
  presenca_aluno PresencaAluno[]
  disciplinas    disciplinas      @relation(fields: [disciplinaId], references: [id])
  horarios_aula  horarios_aula?   @relation(fields: [horarioAulaId], references: [id])
  professores    professores      @relation(fields: [professorId], references: [id])
  turmas         turmas           @relation(fields: [turmaId], references: [id])
}

model turmas {
  id                  String                @id
  nome                String
  ano                 Int
  periodo             String
  professorId         String?
  createdAt           DateTime              @default(now())
  updatedAt           DateTime
  anoLetivo           Int                   @default(2025)
  alunos              alunos[]
  disciplinas_turmas  disciplinas_turmas[]
  frequencias         frequencias[]
  grade_horaria       grade_horaria?
  matriculas          matriculas[]
  registro_frequencia registro_frequencia[]
  professores         professores?          @relation(fields: [professorId], references: [id])
  disciplinas         disciplinas[]         @relation("DisciplinaToTurma")

  // Índices para otimização de performance
  @@index([professorId])
  @@index([anoLetivo])
  @@index([nome])
  @@index([ano, periodo])
}

model usuarios {
  id               String          @id
  nome             String
  email            String          @unique
  senha            String
  tipo             String          @default("USUARIO")
  cargo            String?
  ativo            Boolean         @default(true)
  resetToken       String?
  resetTokenExpira DateTime?
  createdAt        DateTime        @default(now())
  updatedAt        DateTime
  
  // FASE 4: Relações RBAC e 2FA
  twoFactorAuth    TwoFactorAuth?
  apiKeys          ApiKey[]
  auditLogs        AuditLog[]
  userRoles        UserRole[]      // RBAC: Múltiplos roles por usuário

  @@index([email])
  @@index([ativo])
}

enum DiaSemana {
  SEGUNDA
  TERCA
  QUARTA
  QUINTA
  SEXTA
  SABADO
}

enum TipoEvento {
  INICIO_ANO_LETIVO
  FIM_ANO_LETIVO
  DIA_LETIVO
  DIA_NAO_LETIVO
  PARADA_PEDAGOGICA
  RECESSO
  SABADO_LETIVO
  FERIADO
  INICIO_TRIMESTRE
  FIM_TRIMESTRE
  PERIODO_EAC
  OUTRO
}

enum TipoPessoa {
  PROFESSOR
  FUNCIONARIO
  EQUIPE_DIRETIVA
}

enum TipoRegistroPonto {
  ENTRADA
  SAIDA
  INTERVALO_INICIO
  INTERVALO_FIM
}

model registro_ponto {
  id                String             @id @default(uuid())
  pessoaId          String
  tipoPessoa        TipoPessoa
  data              DateTime           @default(now())
  horaRegistro      DateTime
  tipoRegistro      TipoRegistroPonto
  localizacao       String?
  observacao        String?
  aprovado          Boolean            @default(true)
  fotoPath          String?
  attestado         Boolean            @default(false)
  reconhecimentoIA  Boolean            @default(false)
  confianca         Float?
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt

  @@index([pessoaId, data])
  @@index([tipoPessoa])
}

model configuracao_jornada {
  id                     String            @id @default(uuid())
  pessoaId               String            @unique
  tipoPessoa             TipoPessoa
  cargaHorariaSemanal    Int               @default(40)
  cargaHorariaDiaria     Int               @default(8)
  horarioEntrada         String?
  horarioSaida           String?
  horarioIntervaloInicio String?
  horarioIntervaloFim    String?
  diasTrabalho           String[]          @default(["SEGUNDA", "TERCA", "QUARTA", "QUINTA", "SEXTA"])
  createdAt              DateTime          @default(now())
  updatedAt              DateTime          @updatedAt

  @@index([pessoaId])
}

model banco_horas {
  id               String      @id @default(uuid())
  pessoaId         String
  tipoPessoa       TipoPessoa
  mes              Int
  ano              Int
  horasTrabalhadas Float       @default(0)
  horasDevidas     Float       @default(0)
  saldo            Float       @default(0)
  observacao       String?
  createdAt        DateTime    @default(now())
  updatedAt        DateTime    @updatedAt

  @@unique([pessoaId, mes, ano])
  @@index([pessoaId])
}

model reconhecimento_facial {
  id            String      @id @default(uuid())
  pessoaId      String      @unique
  tipoPessoa    TipoPessoa
  descritores   String      // JSON array de descritores faciais
  fotos         String[]    // URLs das fotos de cadastro
  cadastradoEm  DateTime    @default(now())
  atualizadoEm  DateTime    @updatedAt
  ativo         Boolean     @default(true)

  @@index([pessoaId])
  @@index([tipoPessoa])
}

// Sistema de Notificações Inteligentes
model configuracao_notificacao {
  id                    String                 @id @default(uuid())
  usuarioId             String                 @unique
  tipoPerfil            TipoPerfilNotificacao  
  whatsappAtivo         Boolean                @default(true)
  smsAtivo              Boolean                @default(false)
  notificarFrequencia   Boolean                @default(true)
  notificarNotas        Boolean                @default(true)
  notificarAlertas      Boolean                @default(true)
  resumoDiario          Boolean                @default(false)
  horarioInicio         String?                @default("08:00")
  horarioFim            String?                @default("20:00")
  frequenciaMensagens   FrequenciaMensagens    @default(TODAS)
  // Filtros específicos (JSON)
  disciplinasIds        String?                // JSON array para professores
  turmasIds             String?                // JSON array para professores
  alunosIds             String?                // JSON array para responsáveis
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt

  @@index([usuarioId])
  @@index([tipoPerfil])
}

model log_notificacao {
  id                String                 @id @default(uuid())
  destinatarioId    String
  tipoPerfil        TipoPerfilNotificacao
  canal             CanalNotificacao
  tipoEvento        TipoEventoNotificacao
  conteudo          String                 // Conteúdo da mensagem
  metadata          String?                // JSON com dados extras (alunoId, disciplinaId, etc)
  status            StatusNotificacao      @default(PENDENTE)
  tentativas        Int                    @default(0)
  erroMsg           String?
  enviadoEm         DateTime?
  confirmarRecebido Boolean                @default(false)
  createdAt         DateTime               @default(now())
  updatedAt         DateTime               @updatedAt

  // Índices para otimização de performance
  @@index([destinatarioId])
  @@index([status])
  @@index([createdAt])
  @@index([destinatarioId, status])
  @@index([tipoEvento])
  @@index([canal])
}

model webhook_message {
  id                String   @id @default(uuid())
  origem            String   // whatsapp, telegram, sms
  remetenteId       String   // Número ou ID do remetente
  destinatarioId    String?  // ID do usuário no sistema
  mensagem          String
  metadata          String?  // JSON com dados extras
  processado        Boolean  @default(false)
  respostaIA        String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([remetenteId])
  @@index([processado])
  @@index([createdAt])
}

enum TipoPerfilNotificacao {
  GESTAO
  PROFESSOR
  RESPONSAVEL
}

enum FrequenciaMensagens {
  TODAS           // Cada evento em tempo real
  ALERTAS         // Apenas alertas importantes
  RESUMO          // Resumo diário
}

enum CanalNotificacao {
  WHATSAPP
  SMS
  TELEGRAM
  EMAIL
}

enum TipoEventoNotificacao {
  NOTA_LANCADA
  FREQUENCIA_FALTA
  FREQUENCIA_PRESENCA
  ALERTA_MEDIA_BAIXA
  ALERTA_FREQUENCIA_BAIXA
  RESUMO_DIARIO
  MENSAGEM_IA
}

enum StatusNotificacao {
  PENDENTE
  ENVIADO
  FALHA
  ENTREGUE
}

model AuditLog {
  id         String   @id @default(uuid())
  userId     String
  userName   String
  action     String   // CREATE, UPDATE, DELETE, LOGIN, LOGOUT
  resource   String   // ALUNO, TURMA, NOTA, FREQUENCIA, etc
  resourceId String?
  details    Json?
  ipAddress  String?
  userAgent  String?
  createdAt  DateTime @default(now())

  user usuarios @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([action])
  @@index([resource])
  @@index([createdAt])
  @@map("audit_logs")
}

// ============================================
// FASE 4: Two-Factor Authentication (2FA)
// ============================================

model TwoFactorAuth {
  id          String   @id @default(uuid())
  userId      String   @unique
  secret      String   // TOTP secret
  enabled     Boolean  @default(false)
  backupCodes String[] // Códigos de backup para recuperação
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user usuarios @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([enabled])
  @@map("two_factor_auth")
}

model TwoFactorLog {
  id        String   @id @default(uuid())
  userId    String
  success   Boolean
  method    String   // totp, backup_code
  ipAddress String?
  userAgent String?
  createdAt DateTime @default(now())

  @@index([userId])
  @@index([createdAt])
  @@map("two_factor_logs")
}

// ============================================
// FASE 4: API Keys para API Pública
// ============================================

model ApiKey {
  id          String    @id @default(uuid())
  name        String    // Nome identificador da chave
  key         String    @unique // Hash da API key
  userId      String?   // Usuário dono da key (opcional)
  permissions String[]  // Permissões específicas da key
  rateLimit   Int       @default(100) // Requests por minuto
  enabled     Boolean   @default(true)
  expiresAt   DateTime?
  lastUsedAt  DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  user usuarios? @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([key])
  @@index([userId])
  @@index([enabled])
  @@map("api_keys")
}

// ============================================
// FASE 4: Machine Learning - Predições
// ============================================

model StudentPrediction {
  id                 String   @id @default(uuid())
  studentId          String   // ID do aluno
  predictionType     String   // performance, dropout_risk, subject_recommendation
  predictedValue     Float    // Valor numérico da predição (0-1 ou nota)
  confidence         Float    // Nível de confiança (0-1)
  features           Json     // Features usadas na predição
  modelVersion       String   // Versão do modelo usado
  recommendations    Json?    // Recomendações baseadas na predição
  createdAt          DateTime @default(now())

  @@index([studentId])
  @@index([predictionType])
  @@index([createdAt])
  @@map("student_predictions")
}

model MLModel {
  id             String   @id @default(uuid())
  name           String   @unique // Nome do modelo
  type           String   // performance_prediction, dropout_detection
  version        String   // Versão do modelo
  accuracy       Float?   // Acurácia do modelo
  parameters     Json     // Hiperparâmetros do modelo
  trainingData   Json?    // Metadados sobre os dados de treino
  active         Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@index([type])
  @@index([active])
  @@map("ml_models")
}

// ============================================
// RBAC - Role Based Access Control (FASE 4)
// ============================================

model Permission {
  id          String   @id @default(uuid())
  name        String   @unique // Ex: "alunos.create", "notas.update", "turmas.delete"
  description String?  // Descrição da permissão
  resource    String   // Recurso: "alunos", "notas", "turmas", etc
  action      String   // Ação: "create", "read", "update", "delete", "list"
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  roles RolePermission[]

  @@index([resource])
  @@index([action])
  @@index([resource, action])
  @@map("permissions")
}

model Role {
  id          String   @id @default(uuid())
  name        String   @unique // Ex: "ADMIN", "PROFESSOR", "COORDENADOR"
  description String?  // Descrição da role
  level       Int      @default(0) // Nível hierárquico (maior = mais permissões)
  isSystem    Boolean  @default(false) // Role do sistema (não pode ser deletada)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  permissions RolePermission[]
  users       UserRole[]

  @@index([level])
  @@map("roles")
}

model RolePermission {
  id           String   @id @default(uuid())
  roleId       String
  permissionId String
  createdAt    DateTime @default(now())

  role       Role       @relation(fields: [roleId], references: [id], onDelete: Cascade)
  permission Permission @relation(fields: [permissionId], references: [id], onDelete: Cascade)

  @@unique([roleId, permissionId])
  @@index([roleId])
  @@index([permissionId])
  @@map("role_permissions")
}

model UserRole {
  id        String   @id @default(uuid())
  userId    String
  roleId    String
  userType  String   // "usuarios", "professor", "funcionario", "equipe_diretiva"
  createdAt DateTime @default(now())

  role    Role     @relation(fields: [roleId], references: [id], onDelete: Cascade)
  usuario usuarios @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, roleId])
  @@index([userId])
  @@index([roleId])
  @@index([userType])
  @@map("user_roles")
}

// ==================== FASE 5: CENTRAL DE COMUNICAÇÃO UNIFICADA ====================

model MessageTemplate {
  id          String   @id @default(uuid())
  name        String   // Nome do template
  category    String   // Ex: "ACADEMICO", "FINANCEIRO", "EVENTOS", "AVISOS"
  channel     String   // "whatsapp", "sms", "email", "push", "all"
  subject     String?  // Para emails
  content     String   @db.Text // Conteúdo com variáveis: {{nome}}, {{turma}}, etc
  variables   Json     // Array de variáveis disponíveis
  isActive    Boolean  @default(true)
  createdBy   String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  messages    Message[]
  schedules   MessageSchedule[]

  @@index([channel])
  @@index([category])
  @@index([isActive])
  @@map("message_templates")
}

model Message {
  id             String    @id @default(uuid())
  templateId     String?
  channel        String    // "whatsapp", "sms", "email", "push"
  recipientType  String    // "aluno", "responsavel", "professor", "funcionario", "turma", "todos"
  recipientId    String?   // ID do destinatário específico
  recipient      String    // Email, telefone ou ID do dispositivo
  subject        String?   // Para emails
  content        String    @db.Text
  status         String    @default("pending") // pending, sent, delivered, failed, read
  sentAt         DateTime?
  deliveredAt    DateTime?
  readAt         DateTime?
  errorMessage   String?   @db.Text
  metadata       Json?     // Dados adicionais do provedor
  sentBy         String    // ID do usuário que enviou
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  template       MessageTemplate? @relation(fields: [templateId], references: [id])

  @@index([channel])
  @@index([recipientType])
  @@index([status])
  @@index([sentAt])
  @@index([createdAt])
  @@map("messages")
}

model MessageSchedule {
  id             String    @id @default(uuid())
  templateId     String
  channel        String    // "whatsapp", "sms", "email", "push", "all"
  recipientType  String    // "aluno", "responsavel", "professor", "turma", "todos"
  recipientIds   Json?     // Array de IDs específicos (null = todos)
  scheduledFor   DateTime  // Data/hora do envio
  recurrence     String?   // "daily", "weekly", "monthly", null
  isActive       Boolean   @default(true)
  lastSentAt     DateTime?
  nextSendAt     DateTime?
  sentCount      Int       @default(0)
  createdBy      String
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  template       MessageTemplate @relation(fields: [templateId], references: [id])

  @@index([scheduledFor])
  @@index([isActive])
  @@index([nextSendAt])
  @@map("message_schedules")
}

model CommunicationChannel {
  id          String   @id @default(uuid())
  channel     String   @unique // "whatsapp", "sms", "email", "push"
  provider    String   // "twilio", "sendgrid", "firebase", etc
  isActive    Boolean  @default(true)
  config      Json     // Configurações específicas do canal (API keys, etc - criptografadas)
  limits      Json?    // Limites de envio (por dia, por mês, etc)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([channel])
  @@index([isActive])
  @@map("communication_channels")
}

model MessageAnalytics {
  id              String   @id @default(uuid())
  date            DateTime @db.Date
  channel         String
  sent            Int      @default(0)
  delivered       Int      @default(0)
  failed          Int      @default(0)
  read            Int      @default(0)
  clicked         Int      @default(0)
  averageDelivery Float?   // Tempo médio de entrega em segundos
  cost            Float?   // Custo total do dia
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@unique([date, channel])
  @@index([date])
  @@index([channel])
  @@map("message_analytics")
}
